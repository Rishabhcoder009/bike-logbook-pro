<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bicycle Maintenance Log</title>

<!-- PWA / iPad App Support -->
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="BikeCare">
<meta name="theme-color" content="#121212">

<style>
body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #ffffff;
    margin: 20px;
}

h1 {
    text-align: center;
}

form {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
}

label {
    display: block;
    margin-top: 10px;
}

select, input {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border-radius: 5px;
    border: none;
}

button {
    margin-top: 10px;
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
}

.add-btn { background: #2d6cdf; color: white; }
.export-btn { background: #28a745; color: white; }
.clear-btn { background: #dc3545; color: white; }

table {
    width: 100%;
    border-collapse: collapse;
    background: #1e1e1e;
    border-radius: 10px;
    overflow: hidden;
}

th, td {
    padding: 10px;
    text-align: center;
}

th {
    background: #2d6cdf;
}

tr:nth-child(even) {
    background: #2a2a2a;
}

.status-btn {
    background: #ff9800;
    color: white;
}

.edit-btn {
    background: #17a2b8;
    color: white;
}

.delete-btn {
    background: #dc3545;
    color: white;
}
</style>
</head>

<body>

<h1>Bicycle Maintenance Log</h1>

<form id="logForm">
<label>Date:</label>
<input type="date" id="date" required>

<label for="task">Task:</label>
<select id="task" required>
<option value="Remove loose dirt">Cleaning - Remove loose dirt</option>
<option value="Wash frame & wheels">Cleaning - Wash frame & wheels</option>
<option value="Clean chain & drivetrain">Cleaning - Clean chain & drivetrain</option>
<option value="Dry thoroughly">Cleaning - Dry thoroughly</option>
<option value="Lubricate moving parts">Cleaning - Lubricate moving parts</option>
<option value="Check tire pressure">Tires & Wheels - Check air pressure</option>
<option value="Inspect tires">Tires & Wheels - Inspect for damage</option>
<option value="Fix flat tire">Tires & Wheels - Fix flat tire</option>
<option value="True wheels">Tires & Wheels - True wheels</option>
<option value="Inspect brake pads">Brakes - Inspect brake pads</option>
<option value="Adjust brake cables">Brakes - Adjust brake cable tension</option>
<option value="Check wheel hubs">Bearings - Wheel hubs</option>
<option value="Check headset">Bearings - Headset</option>
<option value="Check pedals & bottom bracket">Bearings - Pedals & Bottom Bracket</option>
<option value="Clean & lubricate chain">Chain - Clean & lubricate</option>
<option value="Check chain tension">Chain - Check chain tension</option>
<option value="Replace stretched chain">Chain - Replace if stretched</option>
<option value="Inspect frame">Frame - Inspect frame</option>
<option value="Tighten bolts">Frame - Tighten bolts</option>
<option value="Check reflectors & bell">Frame - Check reflectors & bell</option>
<option value="Flat tire repair">DIY - Flat tire repair</option>
<option value="Loose brakes adjustment">DIY - Loose brakes adjustment</option>
<option value="Squeaky chain lubrication">DIY - Squeaky chain lubrication</option>
<option value="Wobbly wheels adjustment">DIY - Wobbly wheels adjustment</option>
<option value="Tighten loose pedals">DIY - Tighten loose pedals</option>
</select>

<button type="submit" class="add-btn">Add Log</button>
</form>

<button onclick="exportToExcel()" class="export-btn">Export to Excel</button>
<button onclick="clearLogs()" class="clear-btn">Clear All Logs</button>

<br><br>

<table>
<thead>
<tr>
<th>Date</th>
<th>Task</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody id="logTable"></tbody>
</table>

<script>
let logs = JSON.parse(localStorage.getItem("bikeLogs")) || [];
let editIndex = null;

function saveLogs() {
    localStorage.setItem("bikeLogs", JSON.stringify(logs));
}

function renderLogs() {
    const table = document.getElementById("logTable");
    table.innerHTML = "";

    logs.forEach((log, index) => {
        table.innerHTML += `
        <tr>
            <td>${log.date}</td>
            <td>${log.task}</td>
            <td>
                <button class="status-btn" onclick="toggleStatus(${index})">
                    ${log.status}
                </button>
            </td>
            <td>
                <button class="edit-btn" onclick="editLog(${index})">Edit</button>
                <button class="delete-btn" onclick="deleteLog(${index})">Delete</button>
            </td>
        </tr>`;
    });
}

document.getElementById("logForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const date = document.getElementById("date").value;
    const task = document.getElementById("task").value;

    if (editIndex === null) {
        logs.push({ date, task, status: "Pending" });
    } else {
        logs[editIndex].date = date;
        logs[editIndex].task = task;
        editIndex = null;
    }

    saveLogs();
    renderLogs();
    this.reset();
});

function toggleStatus(index) {
    logs[index].status =
        logs[index].status === "Pending" ? "Completed" : "Pending";
    saveLogs();
    renderLogs();
}

function editLog(index) {
    document.getElementById("date").value = logs[index].date;
    document.getElementById("task").value = logs[index].task;
    editIndex = index;
}

function deleteLog(index) {
    logs.splice(index, 1);
    saveLogs();
    renderLogs();
}

function clearLogs() {
    if (confirm("Are you sure you want to clear all logs?")) {
        logs = [];
        saveLogs();
        renderLogs();
    }
}

function exportToExcel() {
    let csv = "Date,Task,Status\n";
    logs.forEach(log => {
        csv += `${log.date},${log.task},${log.status}\n`;
    });

    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "bike_maintenance_log.csv";
    a.click();
}

renderLogs();
</script>

</body>
</html>
